var __index = {"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"index.html","title":"Home","text":"css add shadow <p>Hi, this is Qihang\ud83d\udc4b. I\u2019m documenting my learning process in this blog. I do believe beautiful and robust design emerges from full-chain optimization and deep integration. That\u2019s why I\u2019m obsessed with connecting the whole value loop. In this blog, I plan to dive into everything from machine-learning algorithms and systems to hardware tweaks, product interaction design, and even the business side that makes it all real.</p> <p> </p>"},{"location":"2025/10/06/max-ent-rl-and-boltzmann-distribution.html","title":"Why the Exponential? From Max\u2011Entropy RL to the Boltzmann Distribution","text":"<p>Modern RL, attention mechanisms, classification, energy-based modeling, and statistical mechanics keep arriving at the same exponential shape:</p> \\[ p(x)\\;\\propto\\;\\exp(\\text{logits or reward}(x)/T)\\quad\\text{or}\\quad p(x)\\;\\propto\\;\\exp(-E(x)/T). \\] <p>Why does the exponential keep showing up, and what does the \"temperature\" actually do?</p> <p>To demonstrate some intuitions, this post will go through three views to explain why the exponential form is ubiquitous:</p> <p>1) Maximum Entropy Reinforcement Learning (MaxEnt RL): the optimal soft policy is an exponential of reward with an entropy-weighted objective;</p> <p>2) Energy-based Models (EBMs): probabilities are Boltzmann weights with a partition function \\(Z\\);</p> <p>3) Statistical Mechanics: Jaynes's maximum-entropy principle and ensemble theory (Boltzmann \u2192 Gibbs \u2192 Shannon \u2192 Jaynes) make the exponential inevitable under mean-value constraints.</p>"},{"location":"2025/10/06/max-ent-rl-and-boltzmann-distribution.html#table-of-contents","title":"Table of Contents","text":"<ul> <li>Why the Exponential? From Max\u2011Entropy RL to the Boltzmann Distribution<ul> <li>Table of Contents</li> <li>Maximum Entropy Reinforcement Learning<ul> <li>Optimal-Soft Policy Form</li> <li>Proof of Optimal-Soft Form<ul> <li>\\(J(\\pi,T)\\) is a Concave function</li> <li>Get The Optimal-Soft Policy Via Method of Lagrange Multipliers</li> </ul> </li> </ul> </li> <li>Energy-Based Models (EBM)<ul> <li>The Very First Energy-Based Model<ul> <li>Hopfield Network</li> <li>Boltzmann Machine</li> </ul> </li> </ul> </li> <li>Boltzmann Distribution and Gibbs Distribution<ul> <li>The Origin of Boltzmann and Gibbs Distribution<ul> <li>Gibbs Distribution: A More General Framework</li> </ul> </li> </ul> </li> <li>Jaynes's Principle of Maximum Entropy<ul> <li>History</li> </ul> </li> <li>Conclusion</li> </ul> </li> </ul>"},{"location":"2025/10/06/max-ent-rl-and-boltzmann-distribution.html#maximum-entropy-reinforcement-learning","title":"Maximum Entropy Reinforcement Learning","text":"<p>Last week I was reading the paper All Roads Lead to Likelihood: The Value of Reinforcement Learning in Fine-Tuning<sup>1</sup>. In their proof to prove that DPO is equivalent to first train a reward model and then do on-policy RL to optimize the LLM with the help of the reward model, they used the conclusion from Maximum Entropy Reinforcement Learning (MaxEnt RL).</p> <p>Since the MaxEnt RL framework underlies many modern reinforcement learning algorithms, I revisit its derivation here. During this process, I also found its close connection to statistical mechanics, which I will elaborate on below.</p>"},{"location":"2025/10/06/max-ent-rl-and-boltzmann-distribution.html#optimal-soft-policy-form","title":"Optimal-Soft Policy Form","text":"<p>In LLM post-training, when we have a reward function \\(r_{\\theta}(\\xi, s_0)\\) to calculate the reward of a given trajectory \\(\\xi\\) generated by a LLM \\(\\pi \\in \\Pi\\) conditioned on the initial state \\(s_0\\), i.e. \\(\\xi \\sim \\pi(\\cdot \\mid s_0)\\), we want to find the optimal-soft policy \\(\\pi_{r_{\\theta}, T}^\\star\\) that maximizes the expected reward while also not too complex so that it won't overfit the learned reward model, which itself acts as a synthetic data proxy.</p> <p>Furthermore, we include an entropy regularization term, following Jaynes's maximum entropy principle, to encourage exploration and prevent degenerate deterministic policies.</p> <p>The Optimal-Soft Policy Form is defined as follows:</p> \\[ \\begin{align}   \\pi _{r _{\\theta}, T}^\\star    &amp;= \\operatorname*{argmax} _{\\pi\\in\\Pi} \\;   \\mathbb{E} _{\\xi\\sim\\pi} \\! \\left[r _{\\theta}(\\xi, s_0)\\right] + T \\cdot \\mathcal{H}(\\pi)\\\\   \\iff &amp; \\pi _{r _{\\theta}, T}^\\star(\\xi \\mid s_0)   = \\frac{\\exp\\!\\big(r _{\\theta}(\\xi, s_0)/T\\big)}{Z(r _{\\theta},s_0,T)},\\\\   &amp; \\text{where }Z(r _{\\theta},s_0,T) = \\sum _{\\xi'\\in \\Xi}\\exp\\!\\big(r _{\\theta}(\\xi', s_0)/T\\big) \\end{align} \\] <p>Where:</p> <ul> <li>\\(\\pi\\) is a policy in \\(\\Pi\\), \\(\\Pi\\) is the set of all possible policies;</li> <li>Both \\(\\xi\\) and \\(\\xi'\\) are trajectories in \\(\\Xi\\), \\(\\Xi\\) is the set of all possible trajectories;</li> <li>\\(s_0\\) is the initial state, \\(s_0 \\sim \\rho(s_0)\\), it is corresponding to the prompt in LLM post-training;</li> <li>\\(T\\) is a temperature parameter that controls the exploration-exploitation trade-off in Reinforcement Learning, or can be explained as a regularization strength that controls the importance of the entropy term in the objective function.</li> </ul>"},{"location":"2025/10/06/max-ent-rl-and-boltzmann-distribution.html#proof-of-optimal-soft-form","title":"Proof of Optimal-Soft Form","text":"<p>If we denote \\(\\pi_i = \\pi_{r_{\\theta}}(\\xi_i \\mid s_0), \\; r_i = r_{\\theta}(\\xi_i \\mid s_0)\\):</p> \\[ \\begin{aligned} J(\\pi,T) &amp;=\\mathbb{E} _{\\xi\\sim\\pi} \\! \\left[r _{\\theta}(\\xi, s_0)\\right] + T \\cdot \\mathcal{H}(\\pi) \\\\ &amp;= \\sum_i \\pi_i r_i -T \\sum_i \\pi_i \\log \\pi_i\\\\ \\end{aligned} \\] \\[ J(\\pi,T) = \\underbrace{\\sum_i \\pi_i r_i}_{R(\\pi)\\text{: Expected Reward}} + T \\cdot \\underbrace{(- \\sum_i \\pi_i \\log \\pi_i)}_{H(\\pi)\\text{: Shannon Entropy}} \\] <p>In this formulation, the variables are \\(\\{\\pi_1,...,\\pi_{\\mid \\Xi \\mid}\\}\\), the constraint is \\(\\displaystyle\\sum_{i = 1}^{\\mid \\Xi \\mid} \\pi_i = 1\\).</p> <p></p>"},{"location":"2025/10/06/max-ent-rl-and-boltzmann-distribution.html#jpit-is-a-concave-function","title":"\\(J(\\pi,T)\\) is a Concave function","text":"<p>Given: + \\(R(\\pi) = \\displaystyle\\sum_{i = 1}^{\\mid \\Xi \\mid} \\pi_i r_i\\) is a linear function with respect to variables \\(\\{p_1,...,p_{\\mid \\Xi \\mid}\\}\\). And thus it is a concave function. + \\(H(\\pi) = - \\displaystyle\\sum_{i = 1}^{\\mid \\Xi \\mid} \\pi_i \\log \\pi_i\\) is a strictly concave function. When \\(T &gt; 0\\), \\(T \\cdot H(\\pi)\\) is also strictly concave.</p> <p>Thus when \\(T &gt; 0\\), the sum \\(J(\\pi,T) = R(\\pi) + T \\cdot H(\\pi)\\) is strictly concave (since the sum of a concave and a strictly concave function is strictly concave).</p> <p>Because \\(J(\\pi,T)\\) is strictly concave under the normalization constraint when \\(T &gt; 0\\), the stationary point found below is the unique global optimum.</p> <p></p>"},{"location":"2025/10/06/max-ent-rl-and-boltzmann-distribution.html#get-the-optimal-soft-policy-via-method-of-lagrange-multipliers","title":"Get The Optimal-Soft Policy Via Method of Lagrange Multipliers","text":"<p>Given \\(J(\\pi,T)\\) is a Concave function, we have the following Lagrange Function:</p> \\[ \\begin{align} \\mathcal{L}(\\pi, T, \\lambda)  &amp;= \\underbrace{J(\\pi,T)}_{\\text{Original Target}} - \\lambda \\cdot \\underbrace{(\\sum_i \\pi_i - 1)}_{\\text{Constrain}} \\\\ &amp;= \\sum_i \\pi_i r_i -T \\sum_i \\pi_i \\log \\pi_i - \\lambda \\left( \\sum_{i = 1}^{\\mid \\Xi \\mid} \\pi_i - 1 \\right) \\end{align} \\] <p>In order to find the maximum, we take the partial derivative with respect to any \\(\\pi_i\\) and set it to zero: $$ \\frac{\\partial \\mathcal{L}}{\\partial \\pi_i} = r_i - T (\\log \\pi_i + 1)  - \\lambda = 0 $$ And we can get  \\(\\pi_i\\):</p> \\[ \\begin{align}     \\log \\pi_i &amp;= -1 -\\lambda/T + r_i/T \\\\     \\pi_i &amp;= \\exp(-1 - \\lambda/T) \\cdot \\exp(r_i/T) \\end{align} \\] <p>Thus: $$ \\pi_{r_{\\theta}}^\\star(\\xi_i \\mid s_0) \\propto \\exp\\big(r_{\\theta}(\\xi_i \\mid s_0) / T\\big) $$</p> <p>And Because \\(\\displaystyle\\sum_{i = 1}^{\\mid \\Xi \\mid} \\pi_{r_{\\theta}} = 1\\), we can get the final form of Optimal-Soft Policy:</p> \\[ \\begin{align} \\pi _{r _{\\theta}, T}^\\star(\\xi \\mid s_0) &amp;= \\frac{\\exp\\!\\big(r _{\\theta}(\\xi, s_0)/T\\big)}{Z(r _{\\theta},s_0,T)}\\\\ \\text{where }Z(r _{\\theta},s_0,T) &amp;= \\sum _{\\xi'\\in \\Xi}\\exp\\!\\big(r _{\\theta}(\\xi', s_0)/T\\big) \\end{align} \\]"},{"location":"2025/10/06/max-ent-rl-and-boltzmann-distribution.html#energy-based-models-ebm","title":"Energy-Based Models (EBM)","text":"<p>We have already known that the Optimal-Soft Policy is \\(\\pi_{r_{\\theta}, T}^\\star(\\xi \\mid s_0) = \\frac{\\exp(r _{\\theta}(\\xi, s_0)/T)}{Z(r _{\\theta},s_0,T)}\\), and we can regard it as a special energy-based model. </p> <p>In the context of energy-based models, we call \\(E(\\xi) = -r_{\\theta}(\\xi, s_0)\\) the energy function, while \\(Z(r_{\\theta}, s_0, T)\\) serves as the partition function that normalizes the probabilities.</p> <p>This identification reveals that the softmax over rewards in RL is mathematically identical to the Boltzmann distribution in physics, with reward playing the role of negative energy.</p>"},{"location":"2025/10/06/max-ent-rl-and-boltzmann-distribution.html#the-very-first-energy-based-model","title":"The Very First Energy-Based Model","text":""},{"location":"2025/10/06/max-ent-rl-and-boltzmann-distribution.html#hopfield-network","title":"Hopfield Network","text":"<p>In 1982, J. Hopfield proposed the Hopfield Network <sup>2</sup>, which first introduced the concept of energy function in neural networks. </p>"},{"location":"2025/10/06/max-ent-rl-and-boltzmann-distribution.html#boltzmann-machine","title":"Boltzmann Machine","text":"<p>The first work that relatively introduced energy based model in Machine Learning should be the paper by Hinton and Sejnowski in 1985 <sup>3</sup>, where they defined the probability distribution of Boltzmann machine via the Boltzmann distribution.</p>"},{"location":"2025/10/06/max-ent-rl-and-boltzmann-distribution.html#problem-setting","title":"Problem Setting:","text":"<ul> <li>Given a set of binary vectors (data) \\(\\{v^L\\}\\), where \\(v^L \\in \\{0,1\\}^L\\).</li> <li>In the dataset they used, there are 4 binary vectors with Length \\(8\\): </li> </ul> \\[ \\begin{align}   \\{&amp;(1,0,0,0) -&gt; (1,0,0,0), \\\\     &amp;(0,1,0,0) -&gt; (0,1,0,0), \\\\     &amp;(0,0,1,0) -&gt; (0,0,1,0), \\\\     &amp;(0,0,0,1) -&gt; (0,0,0,1)\\}   \\end{align} \\]"},{"location":"2025/10/06/max-ent-rl-and-boltzmann-distribution.html#the-energy-function-of-boltzmann-machine","title":"The Energy Function of Boltzmann Machine","text":"<p>The energy function of a Boltzmann machine is defined as follows:</p> \\[ E = - \\sum_{i &lt; j} w_{ij} s_i s_j - \\sum_i \\theta_i s_i \\] <p>Where:</p> <ul> <li>\\(E\\) is the energy of a global configuration of the network,</li> <li>\\(w_{ij}\\) are the weights between units \\(i\\) and \\(j\\),</li> <li>\\(s_i\\) is 1 if unit \\(i\\) is on, and 0 if it is off,</li> <li>\\(\\theta_i\\) is a threshold for unit \\(i\\).</li> </ul> <p>As shown in the figure below, in their experiments setting, the Boltzmann machine has totally 10 units: the visible units 1-4 are corresponding to the first 4 digits, the visible units 7-10 are corresponding to the last 4 digits. The hidden units 5-6 are used to construct a information bottleneck and also disentangle the two part of data.</p> <pre><code>flowchart TD\n  subgraph V1 [Visible Units]\n    direction LR\n    v1_1[Unit 1]\n    v1_2[Unit 2]\n    v1_3[Unit 3]\n    v1_4[Unit 4]\n\n    %% use invisible links to force horizontal layout\n    v1_1 ~~~ v1_2 ~~~ v1_3 ~~~ v1_4\n  end\n\n  subgraph H [Hidden Units]\n    direction LR\n    h1[Unit 5]\n    h2[Unit 6]\n\n    %% use invisible links to force horizontal layout\n    h1 ~~~ h2\n  end\n\n  subgraph V2 [Visible Units]\n    direction LR\n    v2_1[Unit 7]\n    v2_2[Unit 8]\n    v2_3[Unit 9]\n    v2_4[Unit 10]\n\n    %% use invisible links to force horizontal layout\n    v2_1 ~~~ v2_2 ~~~ v2_3 ~~~ v2_4\n  end\n\n  V1 ~~~ H\n  H ~~~ V2\n\n  style V1 fill:#e6f3ff,stroke:#333,stroke-width:2px\n  style H fill:#fffbe6,stroke:#333,stroke-width:2px\n  style V2 fill:#e6ffed,stroke:#333,stroke-width:2px</code></pre>"},{"location":"2025/10/06/max-ent-rl-and-boltzmann-distribution.html#the-probability-distribution-of-boltzmann-machine","title":"The Probability Distribution of Boltzmann Machine","text":"<p>The probability distribution over the states of the Boltzmann machine is given by the Boltzmann distribution:</p> \\[ \\frac{P_{\\alpha}}{P_{\\beta}} = e^{-(E_{\\alpha} - E_{\\beta})/T} \\] <p>Where:</p> <ul> <li>\\(P_{\\alpha}\\) is the probability of the network being in \\(\\alpha^{th}\\) state;</li> <li>\\(E_{\\alpha}\\) is the energy of the corresponding state.</li> </ul> <p>Thus for arbitrary state \\(\\alpha\\), we can get the probability of the network being in this state:</p> \\[ P_{\\alpha} = \\frac{e^{-E_{\\alpha}/T}}{\\displaystyle\\sum_{\\alpha^{\\prime} \\in \\mathcal{A}} e^{-E_{\\alpha^{\\prime}}/T}} = \\frac{e^{-E_{\\alpha}/T}}{Z} \\] <p>Where:</p> <ul> <li>\\(\\mathcal{A}\\) is the set of all possible states of the network;</li> <li>\\(Z = \\displaystyle\\sum_{\\alpha^{\\prime} \\in \\mathcal{A}} e^{-E_{\\alpha^{\\prime}}/T}\\) is the partition function, ensuring that the probabilities sum to 1.</li> </ul>"},{"location":"2025/10/06/max-ent-rl-and-boltzmann-distribution.html#optimization-of-boltzmann-machine","title":"Optimization of Boltzmann Machine","text":"<p>Optimization of Boltzmann machine is to minimize the Kullback-Leibler divergence between the data distribution and the model distribution, which is equivalent to maximizing the log-likelihood of the data under the model.</p> \\[ G = \\sum_{\\alpha} P(V_{\\alpha}) \\log \\frac{P(V_{\\alpha})}{P^{\\prime}(V_{\\alpha})} \\] <p>Where:</p> <ul> <li>\\(P(V_{\\alpha})\\) is the data distribution;</li> <li>\\(P^{\\prime}(V_{\\alpha})\\) is the model distribution defined by energy based model.</li> </ul> <p>They optimize \\(G\\) via stochastic gradient descent on the energy parameters, a precursor to the contrastive divergence training used in later works.</p>"},{"location":"2025/10/06/max-ent-rl-and-boltzmann-distribution.html#boltzmann-distribution-and-gibbs-distribution","title":"Boltzmann Distribution and Gibbs Distribution","text":"<p>After the above sections, we can realize that the ubiquitous exponential form in probabilistic models originates from statistical mechanics:</p> <ul> <li> <p>Generally speaking, the Boltzmann distribution refers specifically to the case under the canonical ensemble (NVT, i.e., constant particle number, volume, and temperature).</p> </li> <li> <p>The Gibbs distribution/measure is a more general concept that refers to any probability distribution of the form \\(p \\propto e^{-\\beta H}\\) and can be applied to other physical ensembles.</p> </li> </ul> <p>The canonical definition of the Boltzmann distribution is as follows:</p> \\[ \\displaystyle P(x) = \\frac{e^{-\\beta E(x)}}{Z} \\] <p>where:</p> <ul> <li>\\(\\displaystyle x\\) represents a specific microstate of the system.</li> <li>\\(\\displaystyle E(x)\\) is the energy of the system in the microstate \\(x\\).</li> <li>\\(\\displaystyle \\beta = \\frac{1}{k_B T}\\) is the inverse temperature. \\(k_B\\) is the Boltzmann constant, and \\(T\\) is the thermodynamic temperature.</li> <li>\\(\\displaystyle Z = \\sum_{x'} e^{-\\beta E(x')}\\) is the partition function, a normalization constant ensuring that the sum of probabilities over all states is 1.</li> </ul>"},{"location":"2025/10/06/max-ent-rl-and-boltzmann-distribution.html#the-origin-of-boltzmann-and-gibbs-distribution","title":"The Origin of Boltzmann and Gibbs Distribution","text":"<p>This beautiful exponential form does not arise out of thin air. </p> <p>Based on the equal probability assumption of the microcanonical ensemble, weak coupling between the system and the heat reservoir, and applying Jaynes's maximum entropy principle (or equivalent combinatorial counting methods) under the constraint of a given average energy, we can derive the Boltzmann distribution of the canonical ensemble. </p> <p>It is consistent with the macroscopic evolutionary direction described by the second law of thermodynamics, but more directly speaking, it is the result of equilibrium statistics and maximum entropy inference.</p> <p>Let's break down the derivation process:</p> <ol> <li> <p>Entropy defined by Boltzmann under Microcanonical Ensemble: </p> <p>For an isolated system with fixed energy, Boltzmann's hypothesis states that all accessible microstates are equally probable. The entropy is defined by the famous Boltzmann formula:</p> \\[ S = k_B \\ln W \\] <p>where \\(W\\) is the total number of microstates.</p> <p></p> </li> <li> <p>Entropy defined by Gibbs under Canonical Ensemble: </p> <p>When the system is no longer isolated but is in contact with a large heat reservoir at constant temperature, the energy of the system will fluctuate. At this point, the probabilities of different energy microstates are no longer equal. </p> <p>Gibbs generalized Boltzmann's entropy definition to the canonical ensemble, defining the entropy as:</p> \\[ S = -k_B \\sum_{x \\in \\mathcal{X}} p(x) \\ln p(x) \\] <p>where: - \\(p(x)\\) is the probability of the system being in microstate \\(x\\).  - \\(\\mathcal{X}\\) is the set of all possible microstates of the system.</p> <p>What's worth noting is that this is exactly the Shannon entropy in information theory when \\(k_B\\) is set to 1. This equivalence between physical and informational entropy later became the foundation of Jaynes's reinterpretation.</p> <p></p> </li> <li> <p>Calculate the explicit form of the distribution of whole system:</p> <ul> <li> <p>From the perspective of maximizing Gibbs Entropy:</p> <p>In order to explicitly calculate the probability distribution \\(p(x)\\), following Jaynes's principle of maximum entropy, we maximize the Gibbs entropy:</p> \\[ S = -k_B \\sum_{x \\in \\mathcal{X}} p(x) \\ln p(x). \\] <p>Under the constraint of fixed average energy of the system, i.e \\(\\displaystyle\\mathbb{E}_{x \\sim p(x)} [E(x)] = U\\), and the normalization condition \\(\\displaystyle\\sum_x p(x) = 1\\), we can formulate the constrained optimization problem as follows:</p> \\[ \\begin{align} \\max_{p(x)} \\quad &amp; -k_B \\sum_{x \\in \\mathcal{X}} p(x) \\ln p(x) \\\\ \\text{subject to} \\quad &amp; \\sum_{x \\in \\mathcal{X}} p(x) = 1, \\\\ &amp; \\sum_{x \\in \\mathcal{X}} p(x) E(x) = U. \\end{align} \\] <p>With the method of lagrange multipliers mentioned before, the unique solution to this constrained optimization problem is the Boltzmann distribution:</p> \\[ p(x) = \\frac{e^{-\\beta E(x)}}{Z}  \\] <p>where:</p> <ul> <li>\\(\\beta = \\frac{1}{k_B T}\\) is the inverse temperature, </li> <li>\\(Z = \\displaystyle \\sum_{x' \\in \\mathcal{X}} e^{-\\beta E(x')}\\) is the partition function.</li> </ul> </li> <li> <p>From the perspective of minimizing Helmholtz free energy:</p> <p>The Helmholtz free energy \\(F\\) (for canonical ensemble at constant \\(N\\), \\(V\\), \\(T\\)) is defined as:</p> \\[ \\begin{align} F &amp;= U - TS \\\\   &amp;= \\sum_{x \\in \\mathcal{X}} p(x) E(x) + k_B T \\sum_{x \\in \\mathcal{X}} p(x) \\ln p(x) \\end{align} \\] <p>where:</p> <ul> <li>\\(U\\) is the internal energy, </li> <li>\\(T\\) is the temperature,</li> <li>\\(S\\) is the entropy.</li> </ul> <p>We can see that:</p> <p>At equilibrium, minimizing the Helmholtz free energy \\(F\\) with respect to the probability distribution \\(p(x)\\) is equivalent to maximizing the entropy \\(S\\) subject to the constraint of fixed average energy \\(\\langle E \\rangle = U\\). Thus, both formulations\u2014entropy maximization under energy constraint and free-energy minimization\u2014lead to the same exponential family distribution.</p> </li> </ul> <p></p> </li> </ol> <p>This distribution relies on several key assumptions, including: weak coupling between the system and the heat reservoir, the thermodynamic limit (large number of degrees of freedom), and exhibiting ergodicity or typicality.</p>"},{"location":"2025/10/06/max-ent-rl-and-boltzmann-distribution.html#gibbs-distribution-a-more-general-framework","title":"Gibbs Distribution: A More General Framework","text":"<p>The concept of the \"Gibbs distribution\" is more general and can unify the description of equilibrium distributions across different statistical ensembles. This is typically achieved by introducing an effective Hamiltonian \\(H_{\\text{eff}}\\), allowing the distribution to be uniformly expressed as \\(p \\propto e^{-\\beta H_{\\text{eff}}}\\).</p> <p>All partition functions share the core form: $$ \\text{Partition Function} = \\sum_{\\text{states}} e^{-\\beta (\\text{Energy-like term})} $$ where \\(\\beta = 1 / (k_B T)\\).</p> Ensemble Constraints Random Variables Effective Hamiltonian \\(H_{\\text{eff}}\\) Partition Function Thermodynamic Free Energy Statistical Free Energy Microcanonical \\(N, V, E\\) (None) Not applicable\u00b9 \\(\\Omega(E,V,N)\\) \\(S=k_B\\ln\\Omega\\) (Fundamental definition) Canonical \\(N, V, T\\) Energy \\(E\\) \\(E\\) \\(Z = \\sum_i e^{-\\beta E_i}\\) \\(F = U - TS\\) \\(F = -k_B T \\ln Z\\) Grand Canonical \\(\\mu, V, T\\) Energy \\(E\\), Particle Number \\(N\\) \\(E-\\mu N\\) \\(\\Xi = \\sum_{N,i} e^{-\\beta(E_i - \\mu N)}\\) \\(\\Omega = U -TS -\\mu N\\) \\(\\Omega = -k_B T \\ln \\Xi\\) Isothermal-Isobaric \\(N, P, T\\) Energy \\(E\\), Volume \\(V\\) \\(E+PV\\) \\(\\Delta = \\int e^{-\\beta(E + PV)} dV\\) \\(G = U - TS + PV\\) \\(G = -k_B T \\ln \\Delta\\) <p>Key Relationships:</p> <ul> <li>From \\(Z\\) to \\(\\Xi\\): \\(\\Xi = \\sum_{N=0}^{\\infty} e^{\\beta \\mu N} Z(N,V,T)\\) (introduces particle number fluctuations)</li> <li>From \\(Z\\) to \\(\\Delta\\): \\(\\Delta = \\int_0^{\\infty} e^{-\\beta PV} Z(N,V,T) dV\\) (introduces volume fluctuations)</li> </ul> <p>Notes:</p> <p>[1] The microcanonical ensemble follows a uniform distribution \\(P(\\text{state}) = 1/\\Omega\\) for accessible states with energy \\(E\\), rather than the exponential Gibbs form \\(p \\propto e^{-\\beta H_{\\text{eff}}}\\). It serves as the foundation for other ensembles but doesn't itself belong to the Gibbs distribution family.</p>"},{"location":"2025/10/06/max-ent-rl-and-boltzmann-distribution.html#jayness-principle-of-maximum-entropy","title":"Jaynes's Principle of Maximum Entropy","text":"<p>Jaynes (1957) recast statistical mechanics as inference under incomplete information: among all distributions consistent with the constraints you actually know, choose the one with maximum Shannon entropy. This yields the canonical Boltzmann/Gibbs form and, equivalently, a free\u2011energy minimization principle.</p>"},{"location":"2025/10/06/max-ent-rl-and-boltzmann-distribution.html#history","title":"History","text":"<ul> <li> <p>1870s (Boltzmann): Proposed the statistical interpretation of entropy, connecting microscopic configurations to macroscopic thermodynamic quantities through the celebrated formula:   $$   S = k_B \\ln W   $$   where \\(S\\) is entropy, \\(k_B\\) is the Boltzmann constant, and \\(W\\) is the number of accessible microstates. This marks the birth of statistical mechanics and introduces the probabilistic foundation of thermodynamics.</p> </li> <li> <p>1902 (Gibbs): Generalized Boltzmann's discrete-state formulation into a probabilistic ensemble theory. For systems in thermal equilibrium with varying probabilities \\(p_i\\) for each microstate \\(i\\), Gibbs defined:   $$   S = -k_B \\sum_i p_i \\ln p_i   $$   and derived the canonical and grand canonical ensembles, where the equilibrium distribution takes the now-fundamental exponential form:   $$   p_i = \\frac{e^{-\\beta E_i}}{Z}, \\quad Z = \\sum_i e^{-\\beta E_i}.   $$</p> </li> <li> <p>1948 (Shannon): Reinterpreted Gibbs's entropy in the context of communication theory as information entropy: <sup>4</sup>   $$   H = -\\sum_x p(x) \\ln p(x),   $$   formally decoupling the mathematical structure of entropy from its physical meaning and laying the foundation of information theory.</p> </li> <li> <p>1957 (Jaynes): Unified Boltzmann\u2013Gibbs statistical mechanics with Shannon's information theory in \"Information Theory and Statistical Mechanics I/II\" <sup>5</sup>.   Jaynes postulated that thermodynamic equilibrium corresponds to the maximum entropy distribution consistent with known constraints:   $$   \\max_{p(x)} \\; -\\sum_x p(x)\\ln p(x)   $$   subject to \\(\\sum_x p(x)=1\\) and \\(\\sum_x p(x)E(x)=U\\).   Solving this yields the canonical Boltzmann distribution:   $$   p(x)=\\frac{e^{-\\beta E(x)}}{Z}.   $$   This reframes statistical mechanics as inference under incomplete information, where maximizing entropy is equivalent to minimizing free energy.</p> </li> </ul>"},{"location":"2025/10/06/max-ent-rl-and-boltzmann-distribution.html#conclusion","title":"Conclusion","text":"<p>Although this note cannot cover every softmax function in machine learning, it provides intuition by illustrating the cases above, demonstrating why the exponential form appears ubiquitously across reinforcement learning, energy-based models, and statistical mechanics.</p> <p>Whenever we introduce Shannon or Gibbs entropy as a regularization or principled constraint, the Gibbs distribution naturally emerges as the optimal solution\u2014making the exponential form not just mathematically convenient, but fundamentally inevitable.</p> <ol> <li> <p>Gokul Swamy, Sanjiban Choudhury, Wen Sun, Zhiwei Steven Wu, and J. Andrew Bagnell. All roads lead to likelihood: the value of reinforcement learning in fine-tuning. 2025. URL: https://arxiv.org/abs/2503.01067, arXiv:2503.01067.\u00a0\u21a9</p> </li> <li> <p>John J. Hopfield. Neural networks and physical systems with emergent collective computational abilities. Proceedings of the National Academy of Sciences, 79(8):2554\u20132558, 1982. doi:10.1073/pnas.79.8.2554.\u00a0\u21a9</p> </li> <li> <p>Geoffrey E. Hinton and Terrence J. Sejnowski. A learning algorithm for boltzmann machines. Cognitive Science, 9(1):147\u2013169, 1985. doi:10.1207/s15516709cog0901_7.\u00a0\u21a9</p> </li> <li> <p>Claude E. Shannon. A mathematical theory of communication. Bell System Technical Journal, 27(3):379\u2013423, 1948. doi:10.1002/j.1538-7305.1948.tb01338.x.\u00a0\u21a9</p> </li> <li> <p>Edwin T. Jaynes. Information theory and statistical mechanics. Physical Review, 106(4):620\u2013630, 1957. doi:10.1103/PhysRev.106.620.\u00a0\u21a9</p> </li> </ol>"},{"location":"2025/10/15/weighted-product-of-experts.html","title":"Test-Time Steering for Lossless Text Compression via Weighted Product of Experts","text":"<p>Blog for Paper: Test-Time Steering for Lossless Text Compression via Weighted Product of Experts. </p> <p>Coming soon.</p>"},{"location":"archive/2025.html","title":"2025","text":""},{"location":"category/qihangs-research.html","title":"Qihang's Research","text":""},{"location":"category/reinforcement-learning.html","title":"Reinforcement Learning","text":""},{"location":"category/information-theory.html","title":"Information Theory","text":""},{"location":"category/statistical-mechanics.html","title":"Statistical Mechanics","text":""},{"location":"category/energy-based-models.html","title":"Energy-Based Models","text":""}]}